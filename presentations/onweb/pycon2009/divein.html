

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Diving In &mdash; PyCon 2009 1 documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="PyCon 2009 1 documentation" href="index.html" />
    <link rel="next" title="builtin modules" href="builtins.html" />
    <link rel="prev" title="&lt;no title&gt;" href="credits.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>PyCon 2009 1 documentation</span></a></h1>
        <h2 class="heading"><span>Diving In</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="credits.html">&lt;no title&gt;</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="builtins.html">builtin modules</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="diving-in">
<h1>Diving In<a class="headerlink" href="#diving-in" title="Permalink to this headline">¶</a></h1>
<p>Lets dissect a working Python Program and try to understand various aspects of it.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">socket</span>
<span class="n">SERVER</span> <span class="o">=</span> <span class="s">&#39;irc.freenode.net&#39;</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">6667</span>
<span class="n">NICKNAME</span> <span class="o">=</span> <span class="s">&#39;phoe6&#39;</span>  <span class="c"># REPLACE WITH YOUR USERNAME</span>
<span class="n">CHANNEL</span> <span class="o">=</span> <span class="s">&#39;#python&#39;</span> <span class="c"># CHANGE CHANNEL IF DESIRED</span>

<span class="n">IRC</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">irc_conn</span><span class="p">():</span>
    <span class="n">IRC</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">SERVER</span><span class="p">,</span><span class="n">PORT</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">send_data</span><span class="p">(</span><span class="n">command</span><span class="p">):</span>
    <span class="n">IRC</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">command</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="n">channel</span><span class="p">):</span>
    <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;JOIN </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">channel</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="n">nickname</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s">&#39;phoe6&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">realname</span><span class="o">=</span><span class="s">&#39;Senthil&#39;</span><span class="p">,</span>
          <span class="n">hostname</span><span class="o">=</span><span class="s">&#39;freenode&#39;</span><span class="p">,</span> <span class="n">servername</span><span class="o">=</span><span class="s">&#39;Server&#39;</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">getpass</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="s">&#39;Enter password for </span><span class="si">%s</span><span class="s">:&#39;</span> <span class="o">%</span> <span class="n">nickname</span><span class="p">)</span>
    <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;PASS </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">password</span><span class="p">)</span>
    <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;USER </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">servername</span><span class="p">,</span> <span class="n">realname</span><span class="p">))</span>
    <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;NICK </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">nickname</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">part</span><span class="p">():</span>
    <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;PART&quot;</span><span class="p">)</span>

<span class="n">irc_conn</span><span class="p">()</span>
<span class="n">login</span><span class="p">(</span><span class="n">NICKNAME</span><span class="p">)</span>
<span class="n">join</span><span class="p">(</span><span class="n">CHANNEL</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="nb">buffer</span> <span class="o">=</span> <span class="n">IRC</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="nb">buffer</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">print</span> <span class="n">msg</span>
        <span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;PING&quot;</span><span class="p">:</span>
            <span class="c"># answer PING with PONG, as RFC 1459 specifies</span>
            <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;PONG </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;PRIVMSG&#39;</span><span class="p">:</span>
            <span class="n">nick_name</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;!&quot;</span><span class="p">)]</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
            <span class="k">print</span> <span class="n">nick_name</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">),</span> <span class="s">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">message</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">part</span><span class="p">()</span>
</pre></div>
</div>
<p>In the above program, you have</p>
<ul class="simple">
<li>modules</li>
<li>function definitions</li>
<li>try and finally block</li>
<li>socket calls.</li>
<li>print statement</li>
</ul>
</div>
<div class="section" id="py3k-what-to-look-for-in-brief">
<h1>Py3K, what to look for in brief<a class="headerlink" href="#py3k-what-to-look-for-in-brief" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>Simpler built-in types.  Instead of having a built-in type for int and then
for long as in Py26, have a single built-in type int in py3k, which will
behave like long and serve for int as well.</li>
<li>In py26, you and str and unicode. Now Its just str, which is internally
unicode. So all strings are unicode in py3k.  There is a separate bytes type
for bytes of characters.</li>
<li>1/5 will be 0.2 in Python3k. If you want the result to be 0, like in
Python26, do 1//5</li>
<li>No comparisons supported between incompatible types. Documents from time
immemorial advised the users to not to rely and it can change anytime. Well
the change has happened.</li>
<li>Its print() function for output now, just like input() function input.
Two things here. Previously in py2x, input() expected an object and raw_input()
was actually used to input. Now in py3k, its just input() which will behave
just like raw_input() before.</li>
<li>Everything is a new style class. All classes that you define will implicitly
be derived from the object class.</li>
<li>There is refactoring tool developed by python hackers which can be used to
port your py2x code to py3k.  Everyones resounding advice is Use It!. This
will help in migration as well fix any issues with the refactoring tool.</li>
</ul>
</div>
<div class="section" id="diving-into-py3k">
<h1>Diving Into Py3K<a class="headerlink" href="#diving-into-py3k" title="Permalink to this headline">¶</a></h1>
<p>Lets look at the same program in Python 3k</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># -*- coding: UTF-8 -*-</span>

<span class="kn">import</span> <span class="nn">socket</span>
<span class="n">SERVER</span> <span class="o">=</span> <span class="s">&#39;irc.freenode.net&#39;</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">6667</span>
<span class="n">NICKNAME</span> <span class="o">=</span> <span class="s">&#39;phoe6&#39;</span>  <span class="c"># REPLACE WITH YOUR USERNAME</span>
<span class="n">CHANNEL</span> <span class="o">=</span> <span class="s">&#39;#python&#39;</span> <span class="c"># CHANGE CHANNEL IF DESIRED</span>

<span class="n">IRC</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">irc_conn</span><span class="p">():</span>
    <span class="n">IRC</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">SERVER</span><span class="p">,</span><span class="n">PORT</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">send_data</span><span class="p">(</span><span class="n">command</span><span class="p">):</span>
    <span class="n">IRC</span><span class="o">.</span><span class="n">send</span><span class="p">((</span><span class="n">command</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\r\n</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="n">channel</span><span class="p">):</span>
    <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;JOIN </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">channel</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="n">nickname</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s">&#39;phoe6&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">realname</span><span class="o">=</span><span class="s">&#39;Senthil&#39;</span><span class="p">,</span>
          <span class="n">hostname</span><span class="o">=</span><span class="s">&#39;freenode&#39;</span><span class="p">,</span> <span class="n">servername</span><span class="o">=</span><span class="s">&#39;Server&#39;</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">getpass</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="s">&#39;Enter password for </span><span class="si">%s</span><span class="s">:&#39;</span> <span class="o">%</span> <span class="n">nickname</span><span class="p">)</span>
    <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;PASS </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">password</span><span class="p">)</span>
    <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;USER </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">servername</span><span class="p">,</span> <span class="n">realname</span><span class="p">))</span>
    <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;NICK </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">nickname</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">part</span><span class="p">():</span>
    <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;PART&quot;</span><span class="p">)</span>

<span class="n">irc_conn</span><span class="p">()</span>
<span class="n">login</span><span class="p">(</span><span class="n">NICKNAME</span><span class="p">)</span>
<span class="n">join</span><span class="p">(</span><span class="n">CHANNEL</span><span class="p">)</span>
<span class="n">filetxt</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;irc_messages.log&#39;</span><span class="p">,</span><span class="s">&#39;a+&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="nb">buffer</span> <span class="o">=</span> <span class="n">IRC</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">buffer</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="nb">buffer</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;PING&quot;</span><span class="p">:</span>
            <span class="c"># answer PING with PONG, as RFC 1459 specifies</span>
            <span class="n">send_data</span><span class="p">(</span><span class="s">&quot;PONG </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;PRIVMSG&#39;</span><span class="p">:</span>
            <span class="n">nick_name</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="n">msg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;!&quot;</span><span class="p">)]</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
            <span class="n">filetxt</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="n">nick_name</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;-&gt;&#39;</span> <span class="o">+</span> <span class="n">message</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)</span> <span class="o">+</span>
                          <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span>
        <span class="n">filetxt</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">part</span><span class="p">()</span>
    <span class="n">filetxt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li>Note the change in print function.</li>
<li>Sending bytes instead ( encoded)</li>
</ul>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="credits.html">&lt;no title&gt;</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="builtins.html">builtin modules</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2009, Senthil Kumaran.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>